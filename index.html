<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Anatomy Flash Cards</title>
<style>
  :root{
    --bg0:#050913;
    --bg1:#071225;
    --fg:#eaf3ff;
    --muted:#9bb6d3;
    --accent:#6ecbff;
    --accent2:#8a7dff;
    --card:#0b1426cc;
    --border:rgba(140,200,255,.28);
    --shadow:0 18px 50px rgba(0,0,0,.45);
    --radius:22px;
    --focus:2px solid rgba(110,203,255,.9);
    --maxw:820px;
    --cardw:min(92vw,520px);
    --cardh:min(62vh,520px);
    --font:system-ui,-apple-system,"Segoe UI",Roboto,Helvetica,Arial,"Apple Color Emoji","Segoe UI Emoji";
  }

  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0;
    font-family:var(--font);
    color:var(--fg);
    background:
      radial-gradient(1200px 800px at 20% 10%, rgba(110,203,255,.16), transparent 60%),
      radial-gradient(900px 700px at 80% 40%, rgba(138,125,255,.14), transparent 62%),
      radial-gradient(700px 700px at 55% 85%, rgba(110,203,255,.10), transparent 60%),
      linear-gradient(180deg, var(--bg0), var(--bg1));
    overflow-x:hidden;
  }

  /* subtle stars */
  .stars{
    position:fixed; inset:0; pointer-events:none; z-index:0;
    background-image:
      radial-gradient(1px 1px at 10% 20%, rgba(255,255,255,.35), transparent 2px),
      radial-gradient(1px 1px at 35% 70%, rgba(255,255,255,.25), transparent 2px),
      radial-gradient(1px 1px at 60% 30%, rgba(255,255,255,.25), transparent 2px),
      radial-gradient(1px 1px at 80% 80%, rgba(255,255,255,.18), transparent 2px),
      radial-gradient(1px 1px at 90% 40%, rgba(255,255,255,.18), transparent 2px),
      radial-gradient(1px 1px at 25% 45%, rgba(255,255,255,.20), transparent 2px);
    opacity:.9;
    filter: blur(.1px);
  }

  .wrap{
    position:relative; z-index:1;
    max-width:var(--maxw);
    margin:0 auto;
    padding:28px 16px 40px;
    display:flex;
    flex-direction:column;
    align-items:center;
    gap:18px;
  }

  h1{
    margin:8px 0 0;
    font-size:clamp(28px, 4vw, 44px);
    letter-spacing:.2px;
    font-weight:900;
    text-align:center;
  }

  .top{
    width:100%;
    display:flex;
    flex-direction:column;
    align-items:center;
    gap:10px;
  }

  .progressRow{
    width:min(92vw, 720px);
    display:flex;
    flex-direction:column;
    gap:10px;
    align-items:center;
  }

  .bar{
    width:100%;
    height:12px;
    border-radius:999px;
    background:rgba(255,255,255,.08);
    border:1px solid rgba(255,255,255,.10);
    overflow:hidden;
  }
  .bar > span{
    display:block;
    height:100%;
    width:0%;
    background:linear-gradient(90deg, rgba(110,203,255,.95), rgba(138,125,255,.95));
    border-radius:999px;
    transition:width .25s ease;
  }

  .counter{
    font-size:clamp(18px, 2.5vw, 30px);
    font-weight:800;
    color:rgba(110,203,255,.95);
  }

  .controls{
    display:flex;
    gap:10px;
    flex-wrap:wrap;
    justify-content:center;
    margin-top:6px;
  }

  button{
    border:0;
    cursor:pointer;
    border-radius:14px;
    padding:10px 14px;
    font-weight:800;
    color:#041018;
    background:rgba(110,203,255,.95);
    box-shadow:0 10px 22px rgba(0,0,0,.25);
    transition:transform .06s ease, filter .15s ease;
  }
  button:hover{transform:translateY(-1px); filter:brightness(1.03)}
  button:active{transform:translateY(0)}
  button.secondary{
    background:rgba(255,255,255,.10);
    color:var(--fg);
    border:1px solid rgba(255,255,255,.14);
  }
  button.danger{
    background:rgba(239,68,68,.92);
    color:#fff;
  }
  button:focus-visible{outline:var(--focus); outline-offset:3px}

  /* Card flip */
  .cardStage{
    width:var(--cardw);
    height:var(--cardh);
    perspective: 1200px;
  }
  .card{
    position:relative;
    width:100%;
    height:100%;
    border-radius:var(--radius);
    transform-style:preserve-3d;
    transition: transform .6s cubic-bezier(.2,.8,.2,1);
    box-shadow: var(--shadow);
    cursor:pointer;
  }
  .card.isFlipped{ transform: rotateY(180deg); cursor:default; }

  .face{
    position:absolute;
    inset:0;
    backface-visibility:hidden;
    border-radius:var(--radius);
    overflow:hidden;
  }

  /* Neon frame */
  .frame{
    position:absolute;
    inset:0;
    border-radius:var(--radius);
    pointer-events:none;
    border:2px solid rgba(140,220,255,.45);
    box-shadow:
      0 0 0 6px rgba(110,203,255,.10) inset,
      0 0 24px rgba(110,203,255,.28),
      0 0 46px rgba(138,125,255,.18);
  }

  /* Front: image (card back) */
  .front{
    background:rgba(10,18,32,.55);
    display:flex;
    align-items:center;
    justify-content:center;
  }
  .front img{
    width:100%;
    height:100%;
    object-fit:cover;
    transform:scale(1.02);
    filter:contrast(1.05) saturate(1.05);
  }
  .front .overlay{
    position:absolute;
    inset:0;
    background:linear-gradient(180deg, rgba(0,0,0,.22), rgba(0,0,0,.48));
  }
  .front .hint{
    position:absolute;
    bottom:16px;
    left:0; right:0;
    text-align:center;
    font-weight:800;
    color:rgba(234,243,255,.92);
    text-shadow:0 6px 22px rgba(0,0,0,.55);
    padding:0 12px;
  }

  /* Back: question + answer box */
  .back{
    transform: rotateY(180deg);
    background: var(--card);
    border:1px solid rgba(255,255,255,.12);
    display:flex;
    flex-direction:column;
    padding:18px;
    gap:14px;
  }
  .q{
    font-size:clamp(18px, 2.2vw, 22px);
    font-weight:900;
    line-height:1.25;
    margin-top:6px;
  }
  .answerRow{
    margin-top:auto;
    display:flex;
    flex-direction:column;
    gap:10px;
  }
  input[type="text"]{
    width:100%;
    padding:14px 14px;
    border-radius:14px;
    border:1px solid rgba(255,255,255,.16);
    background:rgba(255,255,255,.06);
    color:var(--fg);
    font-size:16px;
    outline:none;
  }
  input[type="text"]::placeholder{color:rgba(155,182,211,.78)}
  input[type="text"]:focus{box-shadow:0 0 0 3px rgba(110,203,255,.18); border-color:rgba(110,203,255,.45)}

  .btnRow{
    display:flex;
    gap:10px;
    flex-wrap:wrap;
    justify-content:center;
  }

  .reveal{
    display:none;
    border-left:3px solid rgba(110,203,255,.75);
    background:rgba(110,203,255,.08);
    padding:10px 12px;
    border-radius:12px;
    color:rgba(234,243,255,.95);
  }
  .reveal.show{display:block}

  .toast{
    position:fixed;
    bottom:18px;
    left:50%;
    transform:translateX(-50%);
    background:rgba(8,18,32,.92);
    border:1px solid rgba(255,255,255,.10);
    color:rgba(234,243,255,.95);
    padding:10px 14px;
    border-radius:999px;
    font-weight:800;
    opacity:0;
    transition:opacity .2s ease;
    z-index:50;
  }
  .toast.show{opacity:1}

  .small{
    color:var(--muted);
    font-size:.95rem;
    text-align:center;
    max-width:62ch;
    line-height:1.4;
  }

  @media (prefers-reduced-motion: reduce){
    .card{transition:none}
    .bar > span{transition:none}
  }
</style>
</head>

<body>
<div class="stars" aria-hidden="true"></div>

<div class="wrap">
  <div class="top">
    <h1>Anatomy Flash Cards</h1>

    <div class="progressRow" aria-label="Progress">
      <div class="bar" aria-hidden="true"><span id="barFill"></span></div>
      <div class="counter" id="counter">1 / 1</div>

      <div class="controls">
        <button class="secondary" id="shuffleBtn" type="button">Shuffle</button>
        <button class="secondary" id="resetBtn" type="button">Reset</button>
      </div>
    </div>
  </div>

  <div class="cardStage" aria-label="Flashcard">
    <div class="card" id="card" role="button" tabindex="0" aria-label="Flashcard. Click to flip.">
      <!-- FRONT (image back of card) -->
      <div class="face front">
        <img id="cardImg" alt="Flashcard back image" />
        <div class="overlay" aria-hidden="true"></div>
        <div class="hint" id="frontHint">Click to flip</div>
        <div class="frame" aria-hidden="true"></div>
      </div>

      <!-- BACK (question + answer input) -->
      <div class="face back">
        <div class="q" id="question">Loading…</div>

        <div class="reveal" id="revealBox" aria-live="polite"></div>

        <div class="answerRow">
          <input id="answerInput" type="text" autocomplete="off" spellcheck="false" placeholder="Type your answer…" />
          <div class="btnRow">
            <button class="secondary" id="revealBtn" type="button">Reveal answer</button>
            <button id="nextBtn" type="button">Next</button>
          </div>
        </div>

        <div class="frame" aria-hidden="true"></div>
      </div>
    </div>
  </div>

  <div class="small" id="statusLine"></div>
</div>

<div class="toast" id="toast" role="status" aria-live="polite" aria-atomic="true"></div>

<script>
/* =========================
   CONFIG
   ========================= */
const IMAGE_DIR = "./Anatomy/images/";                 // where your images live
const MANIFEST_URL = IMAGE_DIR + "manifest.json";     // you create this file

/* =========================
   FLASHCARD DATA (edit this)
   ========================= */
const DECK = [
  { q: "Deltoid — innervation?", a: "Axillary nerve (C5–C6)." },
  { q: "Supraspinatus — primary role?", a: "Initiates abduction (0–15°)." },
  { q: "Midshaft humerus fracture — key nerve risk?", a: "Radial nerve (radial groove) → wrist drop." }
];

/* =========================
   State
   ========================= */
const $ = (s) => document.querySelector(s);
const card = $("#card");
const cardImg = $("#cardImg");
const questionEl = $("#question");
const counterEl = $("#counter");
const barFill = $("#barFill");
const answerInput = $("#answerInput");
const revealBox = $("#revealBox");
const statusLine = $("#statusLine");

const toastEl = $("#toast");

let images = [];           // list of filenames from manifest
let deck = [];             // shuffled deck
let idx = 0;
let lastImage = null;

function say(msg){
  toastEl.textContent = msg;
  toastEl.classList.add("show");
  clearTimeout(say._t);
  say._t = setTimeout(() => toastEl.classList.remove("show"), 1400);
}

function shuffle(arr){
  const a = [...arr];
  for(let i=a.length-1;i>0;i--){
    const j = Math.floor(Math.random()*(i+1));
    [a[i],a[j]] = [a[j],a[i]];
  }
  return a;
}

/* =========================
   Load image manifest
   ========================= */
async function loadManifest(){
  try{
    const res = await fetch(MANIFEST_URL, { cache: "no-store" });
    if(!res.ok) throw new Error("Manifest not found");
    const data = await res.json();

    // Support either: { images: [...] } OR [...]
    const list = Array.isArray(data) ? data : (data.images || []);
    images = list.filter(Boolean);

    if(!images.length){
      statusLine.textContent =
        "Manifest loaded, but it contains no images. Add filenames to Anatomy/images/manifest.json.";
    }else{
      statusLine.textContent =
        "Tip: Click the card back image to flip. Space also flips. Enter reveals answer when flipped.";
    }
  }catch(err){
    images = [];
    statusLine.textContent =
      "Could not load Anatomy/images/manifest.json yet. Add it to enable random card-back images.";
  }
}

function pickRandomImage(){
  if(!images.length) return null;

  // avoid immediate repeats when possible
  if(images.length === 1) return images[0];

  let pick = images[Math.floor(Math.random()*images.length)];
  let tries = 0;
  while(pick === lastImage && tries < 6){
    pick = images[Math.floor(Math.random()*images.length)];
    tries++;
  }
  lastImage = pick;
  return pick;
}

function setCardBackImage(){
  const filename = pickRandomImage();
  if(!filename){
    // fallback: gradient placeholder
    cardImg.removeAttribute("src");
    cardImg.style.display = "none";
    card.querySelector(".front").style.background =
      "radial-gradient(800px 600px at 30% 25%, rgba(110,203,255,.22), transparent 55%)," +
      "radial-gradient(700px 600px at 70% 70%, rgba(138,125,255,.18), transparent 60%)," +
      "linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.02))";
    $("#frontHint").textContent = "Add Anatomy/images/manifest.json to enable random images";
    return;
  }

  // show image again if previously hidden
  cardImg.style.display = "block";
  $("#frontHint").textContent = "Click to flip";

  // encode filename to handle spaces safely
  const url = IMAGE_DIR + encodeURIComponent(filename);
  cardImg.src = url;
  cardImg.onerror = () => {
    // If a filename is wrong in the manifest, degrade gracefully
    cardImg.style.display = "none";
    $("#frontHint").textContent = "Image not found. Check manifest.json filenames.";
  };
}

function render(){
  if(!deck.length){
    questionEl.textContent = "No cards in deck.";
    counterEl.textContent = "0 / 0";
    barFill.style.width = "0%";
    return;
  }

  const cur = deck[idx];
  questionEl.textContent = cur.q;

  counterEl.textContent = `${idx+1} / ${deck.length}`;
  barFill.style.width = `${Math.round(((idx+1)/deck.length)*100)}%`;

  answerInput.value = "";
  revealBox.classList.remove("show");
  revealBox.textContent = "";

  // Always start on the image side for each card
  card.classList.remove("isFlipped");
  card.setAttribute("aria-label", "Flashcard. Click to flip.");

  setCardBackImage();
}

function revealAnswer(){
  const cur = deck[idx];
  revealBox.textContent = "Answer: " + cur.a;
  revealBox.classList.add("show");
}

function nextCard(){
  if(!deck.length) return;
  idx = (idx + 1) % deck.length;
  render();
  say("Next");
}

/* =========================
   Interactions
   ========================= */
function flipToQuestion(){
  card.classList.add("isFlipped");
  card.setAttribute("aria-label", "Flashcard question. Type your answer.");
  setTimeout(() => answerInput.focus(), 250);
}

function flipToImage(){
  card.classList.remove("isFlipped");
  card.setAttribute("aria-label", "Flashcard. Click to flip.");
}

card.addEventListener("click", () => {
  if(card.classList.contains("isFlipped")) return; // when flipped, use buttons instead
  flipToQuestion();
});

card.addEventListener("keydown", (e) => {
  if(e.key === " "){
    e.preventDefault();
    if(!card.classList.contains("isFlipped")) flipToQuestion();
    else flipToImage();
  }
  if(e.key === "Enter" && card.classList.contains("isFlipped")){
    e.preventDefault();
    revealAnswer();
  }
  if(e.key === "ArrowRight"){
    e.preventDefault();
    nextCard();
  }
});

$("#revealBtn").addEventListener("click", () => {
  revealAnswer();
  answerInput.focus();
});
$("#nextBtn").addEventListener("click", nextCard);

$("#shuffleBtn").addEventListener("click", () => {
  deck = shuffle(DECK);
  idx = 0;
  render();
  say("Shuffled");
});
$("#resetBtn").addEventListener("click", () => {
  deck = [...DECK];
  idx = 0;
  render();
  say("Reset");
});

/* Optional: Enter in the input reveals the answer (keeps hands on keyboard) */
answerInput.addEventListener("keydown", (e) => {
  if(e.key === "Enter"){
    e.preventDefault();
    revealAnswer();
  }
});

/* =========================
   Init
   ========================= */
(async function init(){
  deck = [...DECK];
  await loadManifest();
  render();
})();
</script>
</body>
</html>
